{% extends 'base_public.html' %}

{% block title %}
    {% if current_filter %}
        {{ current_filter|title }} - Zabantu
    {% else %}
        Publications - Zabantu
    {% endif %}
{% endblock %}

{% block banner_title %}
    {% if current_filter %}
        {{ current_filter|title }}
    {% else %}
        Toutes nos publications
    {% endif %}
{% endblock %}

{% block banner_subtitle %}
    Découvrez les travaux du cercle Zabantu
{% endblock %}

{% block content %}
<style>
    .publication-container {
        display: flex;
        gap: 2rem;
    }
    .filter-sidebar {
        width: 250px;
        flex-shrink: 0;
    }
    .articles-list {
        flex: 1;
    }
    .filter-title {
        font-weight: 600;
        color: var(--zabantu-primary);
        margin-bottom: 1rem;
    }
    .filter-list {
        list-style: none;
        padding: 0;
    }
    .filter-item {
        margin-bottom: 0.5rem;
    }
    .filter-link {
        display: block;
        padding: 0.5rem 1rem;
        color: #333;
        text-decoration: none;
        border-radius: 4px;
        transition: all 0.3s;
    }
    .filter-link:hover, .filter-link.active {
        background-color: var(--zabantu-light);
        color: var(--zabantu-primary);
    }
    .filter-link.active {
        font-weight: 600;
        border-left: 3px solid var(--zabantu-primary);
    }
    .article-card {
        margin-bottom: 2rem;
        border-left: 3px solid var(--zabantu-secondary);
        padding-left: 1rem;
    }
    @media (max-width: 768px) {
        .publication-container {
            flex-direction: column;
        }
        .filter-sidebar {
            width: 100%;
            order: -1;
            margin-bottom: 2rem;
        }
    }
</style>

<div class="container">
    <div class="publication-container">
        <!-- Sidebar des filtres -->
        <div class="filter-sidebar">
            <h3 class="filter-title">Catégories</h3>
            <ul class="filter-list">
                <li class="filter-item">
                    <a href="{% url 'public_article_list' %}" 
                       class="filter-link {% if not current_filter %}active{% endif %}">
                        Toutes les publications
                        <span class="badge bg-secondary float-end">{{ articles.count }}</span>
                    </a>
                </li>
                <li class="filter-item">
                    <a href="{% url 'public_article_list' %}?type=seminaire" 
                       class="filter-link {% if current_filter == 'seminaire' %}active{% endif %}">
                        Séminaires
                        <span class="badge bg-secondary float-end">{{ categories.seminaire }}</span>
                    </a>
                </li>
                <li class="filter-item">
                    <a href="{% url 'public_article_list' %}?type=analyse" 
                       class="filter-link {% if current_filter == 'analyse' %}active{% endif %}">
                        Analyses
                        <span class="badge bg-secondary float-end">{{ categories.analyse }}</span>
                    </a>
                </li>
                <li class="filter-item">
                    <a href="{% url 'public_article_list' %}?type=publication" 
                       class="filter-link {% if current_filter == 'publication' %}active{% endif %}">
                        Publications
                        <span class="badge bg-secondary float-end">{{ categories.publication }}</span>
                    </a>
                </li>
            </ul>
        </div>

        <!-- Liste des articles -->
        <div class="articles-list">
            {% if articles %}
                {% for article in articles %}
                <div class="article-card">
                    <h3>
                        <a href="{% url 'public_article_detail' article.slug %}" 
                           style="color: var(--zabantu-primary); text-decoration: none;">
                            {{ article.title }}
                        </a>
                    </h3>
                    <div class="d-flex gap-2 mb-2">
                        <span class="badge bg-primary">{{ article.get_category_display }}</span>
                        <span class="text-muted">{{ article.created_at|date:"d F Y" }}</span>
                    </div>
                    <p>{{ article.content|striptags|truncatewords:30 }}</p>
                    <a href="{% url 'public_article_detail' article.slug %}" class="btn btn-outline-primary btn-sm">
                        Lire la suite
                    </a>
                </div>
                {% endfor %}
            {% else %}
                <div class="alert alert-info">
                    Aucun article disponible dans cette catégorie.
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}